<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Rediscover • Gear Builder</title>
  <style>
    body {
      background: #111;
      color: #f5d76e;
      font-family: Cinzel, serif;
      text-align: center;
    }
    h1 {
      margin: 20px;
      font-size: 28px;
      text-shadow: 0 0 10px #f5d76e;
    }
    .circle {
      position: relative;
      width: 400px;
      height: 400px;
      margin: 20px auto;
      border-radius: 50%;
      box-shadow: 0 0 40px 10px rgba(245,215,110,0.4);
    }
    .slot {
      position: absolute;
      width: 90px;
      height: 90px;
      line-height: 90px;
      background: #222;
      color: #ccc;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 0 10px #000;
    }
    .slot.glow {
      box-shadow: 0 0 20px 4px #f5d76e;
      color: #fff;
    }
    #clearAll {
      background: #e74c3c;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 20px;
      cursor: pointer;
    }
    /* Modal */
    #gearModal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.7);
      z-index: 100;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: #222;
      padding: 20px;
      border-radius: 10px;
      width: 350px;
      color: #fff;
      text-align: left;
      box-shadow: 0 0 20px #000;
    }
    .modal-header {
      font-size: 20px;
      color: #f5d76e;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
    }
    .close {
      cursor: pointer;
      font-size: 20px;
      color: #e74c3c;
      font-weight: bold;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    select, input {
      width: 100%;
      margin-top: 5px;
      padding: 5px;
      border-radius: 4px;
      border: none;
    }
    #specialWrapper label {
      color: purple;
      font-weight: bold;
    }
    button.saveBtn {
      background: #2ecc71;
      color: white;
      border: none;
      margin-top: 15px;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Rediscover • Gear Builder</h1>
  <div class="circle" id="gearCircle">
    <div class="slot" style="top:10px; left:155px;" data-slot="Helm">Helm</div>
    <div class="slot" style="top:80px; right:40px;" data-slot="Chest">Chest</div>
    <div class="slot" style="top:230px; right:40px;" data-slot="Gloves">Gloves</div>
    <div class="slot" style="top:330px; left:155px;" data-slot="Boots">Boots</div>
    <div class="slot" style="top:230px; left:40px;" data-slot="Ring">Ring</div>
    <div class="slot" style="top:80px; left:40px;" data-slot="Necklace">Necklace</div>
    <div class="slot" style="top:155px; left:0px;" data-slot="Weapon">Weapon</div>
    <div class="slot" style="top:330px; left:155px;" data-slot="Belt">Belt</div>
  </div>
  <button id="clearAll">Clear All</button>

  <!-- Modal -->
  <div id="gearModal">
    <div class="modal-content">
      <div class="modal-header">
        <span>Edit Gear</span>
        <span class="close" id="closeModal">&times;</span>
      </div>
      <label for="tier">Tier</label>
      <select id="tier">
        <option value="Primal">Primal</option>
        <option value="Original">Original</option>
        <option value="Chaos">Chaos</option>
        <option value="Abyss">Abyss</option>
      </select>
      <label for="rune">Rune</label>
      <select id="rune"></select>
      <input id="runeValue" type="text" placeholder="Rune Value">

      <div id="specialWrapper" style="display:none;">
        <label for="special">Option</label>
        <select id="special"></select>
        <input id="specialValue" type="text" placeholder="Value">
      </div>

      <div id="linesWrapper"></div>
      <button class="saveBtn" id="saveGear">Save</button>
    </div>
  </div>

  <script>
    const slots = document.querySelectorAll('.slot');
    const modal = document.getElementById('gearModal');
    const closeModal = document.getElementById('closeModal');
    const tierSelect = document.getElementById('tier');
    const runeSelect = document.getElementById('rune');
    const linesWrapper = document.getElementById('linesWrapper');
    const specialWrapper = document.getElementById('specialWrapper');
    const specialSelect = document.getElementById('special');
    const specialValue = document.getElementById('specialValue');

    // Example stat list (use gearDefs.json in final)
    const statList = [
      "ATK%", "Crit Chance", "Crit Damage", "Attack Speed",
      "HP%", "DEF%", "DR%", "Evasion", "Lifesteal",
      "Racial Damage", "Boss Damage", "Undead Damage",
      "Primate Damage", "Animal Damage"
    ];

    // Populate rune dropdown
    function fillRunes() {
      runeSelect.innerHTML = "";
      statList.forEach(stat => {
        let opt = document.createElement("option");
        opt.value = stat;
        opt.text = stat;
        runeSelect.appendChild(opt);
      });
    }

    fillRunes();

    // Open modal on slot click
    slots.forEach(slot => {
      slot.addEventListener('click', () => {
        modal.style.display = 'flex';
        linesWrapper.innerHTML = "";
        let tier = tierSelect.value;
        let lineCount = (tier === "Primal") ? 3 : 4;

        for (let i = 0; i < lineCount; i++) {
          let div = document.createElement("div");
          div.innerHTML = `
            <label>Line ${i+1}</label>
            <select>
              ${statList.map(s => `<option value="${s}">${s}</option>`).join("")}
            </select>
            <input type="text" placeholder="Value">
          `;
          linesWrapper.appendChild(div);
        }

        // Handle Option (special purple stat)
        if (tier === "Chaos" || tier === "Abyss") {
          specialWrapper.style.display = "block";
          specialSelect.innerHTML = "";
          ["Crit Damage +80%", "HP% +52%", "Boss Damage +25%"].forEach(opt => {
            let o = document.createElement("option");
            o.value = opt; o.text = opt;
            specialSelect.appendChild(o);
          });
        } else {
          specialWrapper.style.display = "none";
        }
      });
    });

    closeModal.addEventListener('click', () => modal.style.display = 'none');
    document.getElementById('clearAll').addEventListener('click', () => {
      slots.forEach(s => s.classList.remove('glow'));
    });
  </script>
</body>
</html>
